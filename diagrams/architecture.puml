@startuml WASM-ROS Architecture
!theme plain
skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle
skinparam roundcorner 10
skinparam shadowing false

title WASM-ROS Communication Architecture\nmicroROS running inside WebAssembly Runtime

package "Kubernetes Cluster" {
    node "K8s Pod 1" {
        component [WASM Runtime] as WASM1 #667eea
        component [microROS\nPublisher Node] as PUB #4CAF50
        component [ROS2 DDS\nTransport] as DDS1 #FFC107
        WASM1 --> PUB : contains
        PUB --> DDS1 : uses
    }
    
    node "K8s Pod 2" {
        component [WASM Runtime] as WASM2 #667eea
        component [microROS\nSubscriber Node] as SUB #f5576c
        component [ROS2 DDS\nTransport] as DDS2 #FFC107
        WASM2 --> SUB : contains
        SUB --> DDS2 : uses
    }
    
    cloud "ROS2 DDS Network" as ROSNET #9C27B0 {
        component [/sensor/temperature\nTopic] as TOPIC
    }
    
    DDS1 <--> ROSNET : ROS2 DDS
    ROSNET <--> DDS2 : ROS2 DDS
    PUB --> TOPIC : publishes
    TOPIC --> SUB : subscribes
}

note right of WASM1
  **WASM Runtime contains:**
  • microROS core
  • ROS2 DDS layer
  • Publisher logic
  All running in WASM
end note

note right of WASM2
  **WASM Runtime contains:**
  • microROS core
  • ROS2 DDS layer
  • Subscriber logic
  All running in WASM
end note

@enduml
