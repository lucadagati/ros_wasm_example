@startuml K8s Deployment
!theme plain
skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle
skinparam roundcorner 10

title Kubernetes Deployment Architecture\nmicroROS running in WASM Runtime

package "Kubernetes Cluster" {
    rectangle "K8s Pod 1" {
        component [WASM Runtime\n(Wasmtime/Wasmer)] as RT1 #667eea
        component [microROS Core] as CORE1 #4CAF50
        component [ROS2 DDS Layer] as DDS1 #FFC107
        component [Publisher Node] as NODE1 #9C27B0
        
        RT1 --> CORE1 : executes
        CORE1 --> DDS1 : uses
        CORE1 --> NODE1 : manages
    }
    
    rectangle "K8s Pod 2" {
        component [WASM Runtime\n(Wasmtime/Wasmer)] as RT2 #667eea
        component [microROS Core] as CORE2 #4CAF50
        component [ROS2 DDS Layer] as DDS2 #FFC107
        component [Subscriber Node] as NODE2 #f5576c
        
        RT2 --> CORE2 : executes
        CORE2 --> DDS2 : uses
        CORE2 --> NODE2 : manages
    }
    
    cloud "ROS2 DDS Network" {
        component [/sensor/temperature] as TOPIC
        component [Other ROS Nodes] as OTHER
    }
    
    DDS1 <--> TOPIC : ROS2 DDS
    DDS2 <--> TOPIC : ROS2 DDS
    TOPIC <--> OTHER : ROS2 DDS
}

package "Kubernetes Orchestration" {
    component [K8s API Server] as K8S
    component [Service Discovery] as SVC
    component [Health Checks] as HEALTH
    
    K8S --> RT1 : manages
    K8S --> RT2 : manages
    SVC --> RT1 : discovers
    SVC --> RT2 : discovers
    HEALTH --> RT1 : monitors
    HEALTH --> RT2 : monitors
}

note right of RT1
  **Complete microROS stack**
  **runs inside WASM:**
  
  • microROS core
  • ROS2 DDS transport
  • Node logic
  • All in WASM sandbox
end note

@enduml
